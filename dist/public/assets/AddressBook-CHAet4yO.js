import{r as d,v as oe,j as e,C as k,e as F,B as c,a$ as U,M as Z,y as T,w as q,i as he,s as me,bh as xe,T as H,Q as ue}from"./index-BbFXQDnE.js";import{I as D}from"./Input-CWq-fe6X.js";import{L as l}from"./label-qlckO57s.js";import{T as pe}from"./textarea-CX8_TXW8.js";import{S as v,a as f,b as y,c as C,d as n}from"./select-CnlAahch.js";import{S as je}from"./switch-C_5RQoQW.js";import{D as M,a as ge,b as $,c as R,d as G,e as Q,f as J}from"./dialog-BYX9Qgqu.js";import{A as ve,a as fe,b as ye,c as Ce,d as Ne,e as Ae,f as De,g as be,h as we}from"./alert-dialog-Cy5A2Iqt.js";import{e as Se}from"./index-DGXJkqEo.js";import{S as ke}from"./ShippingApiService-MHXR_pMK.js";import{S as Fe}from"./square-pen-uuUha1pv.js";import{T as Be}from"./trash-2-CmRk35al.js";import{B as ze}from"./building-BXLNYb9P.js";import"./index-BdQq_4o_.js";import"./index-ByjSl0Ku.js";import"./Combination-D3IprPQZ.js";import"./index-7AG9p6tt.js";import"./chevron-up-CwwMYm58.js";import"./index-BFVgSO2V.js";const b={getAddresses:async()=>[],addAddress:async x=>x,updateAddress:async(x,N)=>N,deleteAddress:async x=>!0,setDefaultAddress:async x=>!0},We=({userId:x,onAddressSelect:N,selectionMode:B=!1})=>{const[z,A]=d.useState([]),[u,K]=d.useState(null),[L,P]=d.useState(null),[W,w]=d.useState(!1),[Y,S]=d.useState(!1),[p,o]=d.useState(!1),[h,I]=d.useState(null),[r,i]=d.useState({type:"home",name:"",phone:"",addressLine1:"",addressLine2:"",landmark:"",division:"",district:"",upazila:"",postalCode:"",deliveryInstructions:"",courierPreference:"",isDefault:!1}),{toast:t}=oe();d.useEffect(()=>{_(),ee()},[x]);const _=async()=>{try{o(!0);const s=await b.getAddresses();A(s)}catch(s){console.error("Error loading addresses:",s),t({title:"Error",description:"Failed to load addresses",variant:"destructive"})}finally{o(!1)}},ee=async()=>{try{K({divisions:[{id:"dhaka",name:"Dhaka",nameBn:"ঢাকা",districts:[{id:"dhaka-district",name:"Dhaka",nameBn:"ঢাকা",upazilas:[{id:"dhanmondi",name:"Dhanmondi",nameBn:"ধানমন্ডি",postalCodes:["1205","1207","1209"]},{id:"gulshan",name:"Gulshan",nameBn:"গুলশান",postalCodes:["1212","1213","1214"]},{id:"uttara",name:"Uttara",nameBn:"উত্তরা",postalCodes:["1230","1231","1232"]}]}]},{id:"chittagong",name:"Chittagong",nameBn:"চট্টগ্রাম",districts:[{id:"chittagong-district",name:"Chittagong",nameBn:"চট্টগ্রাম",upazilas:[{id:"panchlaish",name:"Panchlaish",nameBn:"পাঁচলাইশ",postalCodes:["4203","4204"]}]}]}]})}catch(s){console.error("Error loading Bangladesh locations:",s)}},X=async s=>{try{const a=await ke.getDeliveryZone(s);I(a)}catch(a){console.error("Error checking delivery zone:",a)}},V=async()=>{try{if(o(!0),!r.name||!r.phone||!r.addressLine1||!r.division||!r.district||!r.upazila||!r.postalCode){t({title:"Validation Error",description:"Please fill in all required fields",variant:"destructive"});return}let s;L?(s=await b.updateAddress(L.id,r),A(a=>a.map(m=>m.id===L.id?s:m)),S(!1),t({title:"Success",description:"Address updated successfully"})):(s=await b.createAddress(r),A(a=>[...a,s]),w(!1),t({title:"Success",description:"Address added successfully"})),i({type:"home",name:"",phone:"",addressLine1:"",addressLine2:"",landmark:"",division:"",district:"",upazila:"",postalCode:"",deliveryInstructions:"",courierPreference:"",isDefault:!1}),P(null),I(null)}catch(s){console.error("Error saving address:",s),t({title:"Error",description:"Failed to save address",variant:"destructive"})}finally{o(!1)}},se=async s=>{try{o(!0),await b.deleteAddress(s),A(a=>a.filter(m=>m.id!==s)),t({title:"Success",description:"Address deleted successfully"})}catch(a){console.error("Error deleting address:",a),t({title:"Error",description:"Failed to delete address",variant:"destructive"})}finally{o(!1)}},ae=async s=>{try{o(!0),await b.setDefaultAddress(s),A(a=>a.map(m=>({...m,isDefault:m.id===s}))),t({title:"Success",description:"Default address updated"})}catch(a){console.error("Error setting default address:",a),t({title:"Error",description:"Failed to update default address",variant:"destructive"})}finally{o(!1)}},re=s=>{P(s),i(s),S(!0),s.postalCode&&X(s.postalCode)},ie=s=>{i(a=>({...a,division:s,district:"",upazila:"",postalCode:""}))},le=s=>{i(a=>({...a,district:s,upazila:"",postalCode:""}))},ne=s=>{i(a=>({...a,upazila:s,postalCode:""}))},te=s=>{i(a=>({...a,postalCode:s})),s.length>=4&&X(s)},de=s=>{switch(s){case"home":return e.jsx(ue,{className:"h-4 w-4"});case"office":return e.jsx(ze,{className:"h-4 w-4"});default:return e.jsx(Z,{className:"h-4 w-4"})}},ce=s=>{switch(s){case"express":return"bg-green-100 text-green-800";case"standard":return"bg-blue-100 text-blue-800";case"remote":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},j=u==null?void 0:u.divisions.find(s=>s.id===r.division),g=j==null?void 0:j.districts.find(s=>s.id===r.district),E=g==null?void 0:g.upazilas.find(s=>s.id===r.upazila),O=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"type",children:"Address Type"}),e.jsxs(v,{value:r.type,onValueChange:s=>i(a=>({...a,type:s})),children:[e.jsx(f,{children:e.jsx(y,{placeholder:"Select address type"})}),e.jsxs(C,{children:[e.jsx(n,{value:"home",children:"Home"}),e.jsx(n,{value:"office",children:"Office"}),e.jsx(n,{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"name",children:"Contact Name *"}),e.jsx(D,{id:"name",value:r.name,onChange:s=>i(a=>({...a,name:s.target.value})),placeholder:"Full name",required:!0})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"phone",children:"Phone Number *"}),e.jsx(D,{id:"phone",value:r.phone,onChange:s=>i(a=>({...a,phone:s.target.value})),placeholder:"+880 1X-XXXX-XXXX",required:!0})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"addressLine1",children:"Address Line 1 *"}),e.jsx(D,{id:"addressLine1",value:r.addressLine1,onChange:s=>i(a=>({...a,addressLine1:s.target.value})),placeholder:"House/Flat number, Road name",required:!0})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"addressLine2",children:"Address Line 2"}),e.jsx(D,{id:"addressLine2",value:r.addressLine2,onChange:s=>i(a=>({...a,addressLine2:s.target.value})),placeholder:"Area, Block, Sector (optional)"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"landmark",children:"Landmark"}),e.jsx(D,{id:"landmark",value:r.landmark,onChange:s=>i(a=>({...a,landmark:s.target.value})),placeholder:"Nearby landmark (optional)"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"division",children:"Division *"}),e.jsxs(v,{value:r.division,onValueChange:ie,children:[e.jsx(f,{children:e.jsx(y,{placeholder:"Select division"})}),e.jsx(C,{children:u==null?void 0:u.divisions.map(s=>e.jsxs(n,{value:s.id,children:[s.name," (",s.nameBn,")"]},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"district",children:"District *"}),e.jsxs(v,{value:r.district,onValueChange:le,disabled:!r.division,children:[e.jsx(f,{children:e.jsx(y,{placeholder:"Select district"})}),e.jsx(C,{children:j==null?void 0:j.districts.map(s=>e.jsxs(n,{value:s.id,children:[s.name," (",s.nameBn,")"]},s.id))})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"upazila",children:"Upazila/Thana *"}),e.jsxs(v,{value:r.upazila,onValueChange:ne,disabled:!r.district,children:[e.jsx(f,{children:e.jsx(y,{placeholder:"Select upazila"})}),e.jsx(C,{children:g==null?void 0:g.upazilas.map(s=>e.jsxs(n,{value:s.id,children:[s.name," (",s.nameBn,")"]},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"postalCode",children:"Postal Code *"}),e.jsxs(v,{value:r.postalCode,onValueChange:te,disabled:!r.upazila,children:[e.jsx(f,{children:e.jsx(y,{placeholder:"Select postal code"})}),e.jsx(C,{children:E==null?void 0:E.postalCodes.map(s=>e.jsx(n,{value:s,children:s},s))})]})]})]}),h&&e.jsx(k,{className:"border-l-4 border-l-blue-500",children:e.jsxs(F,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Delivery Information"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Zone: ",e.jsx(T,{className:ce(h.zone),children:h.zone.toUpperCase()})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Estimated delivery: ",h.estimatedDays]}),h.additionalCharge>0&&e.jsxs("p",{className:"text-sm text-orange-600",children:["Additional charge: ৳",h.additionalCharge]})]}),e.jsx(H,{className:"h-8 w-8 text-blue-500"})]}),e.jsx("div",{className:"mt-2",children:e.jsxs("p",{className:"text-xs text-gray-500",children:["Available couriers: ",h.courierServices.join(", ")]})})]})}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"courierPreference",children:"Preferred Courier"}),e.jsxs(v,{value:r.courierPreference,onValueChange:s=>i(a=>({...a,courierPreference:s})),children:[e.jsx(f,{children:e.jsx(y,{placeholder:"Select preferred courier"})}),e.jsxs(C,{children:[e.jsx(n,{value:"pathao",children:"Pathao"}),e.jsx(n,{value:"paperfly",children:"Paperfly"}),e.jsx(n,{value:"sundarban",children:"Sundarban"}),e.jsx(n,{value:"redx",children:"RedX"}),e.jsx(n,{value:"ecourier",children:"eCourier"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"deliveryInstructions",children:"Delivery Instructions"}),e.jsx(pe,{id:"deliveryInstructions",value:r.deliveryInstructions,onChange:s=>i(a=>({...a,deliveryInstructions:s.target.value})),placeholder:"Special delivery instructions (optional)",rows:3})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(je,{id:"isDefault",checked:r.isDefault,onCheckedChange:s=>i(a=>({...a,isDefault:s}))}),e.jsx(l,{htmlFor:"isDefault",children:"Set as default address"})]})]});return p&&z.length===0?e.jsx("div",{className:"container mx-auto p-6",children:e.jsx("div",{className:"grid gap-4",children:[1,2,3].map(s=>e.jsx(k,{className:"animate-pulse",children:e.jsx(F,{className:"p-6",children:e.jsx("div",{className:"h-24 bg-gray-200 rounded"})})},s))})}):e.jsxs("div",{className:"container mx-auto p-6 max-w-4xl space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Address Book"}),e.jsx("p",{className:"text-gray-600",children:"Manage your delivery addresses"})]}),e.jsxs(M,{open:W,onOpenChange:w,children:[e.jsx(ge,{asChild:!0,children:e.jsxs(c,{children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Add New Address"]})}),e.jsxs($,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(R,{children:[e.jsx(G,{children:"Add New Address"}),e.jsx(Q,{children:"Add a new delivery address with Bangladesh location details"})]}),e.jsx(O,{}),e.jsxs(J,{children:[e.jsx(c,{variant:"outline",onClick:()=>w(!1),children:"Cancel"}),e.jsx(c,{onClick:V,disabled:p,children:p?"Saving...":"Save Address"})]})]})]})]}),e.jsx("div",{className:"grid gap-4",children:z.length===0?e.jsx(k,{children:e.jsxs(F,{className:"p-8 text-center",children:[e.jsx(Z,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No addresses found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Add your first delivery address to get started"}),e.jsxs(c,{onClick:()=>w(!0),children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Add Address"]})]})}):z.map(s=>e.jsx(k,{className:`${s.isDefault?"ring-2 ring-blue-500":""} ${B?"cursor-pointer hover:bg-gray-50":""}`,onClick:()=>B&&(N==null?void 0:N(s)),children:e.jsx(F,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[de(s.type),e.jsx("span",{className:"font-medium capitalize",children:s.type}),s.isDefault&&e.jsxs(T,{className:"bg-blue-100 text-blue-800",children:[e.jsx(q,{className:"h-3 w-3 mr-1"}),"Default"]}),s.verified&&e.jsxs(T,{className:"bg-green-100 text-green-800",children:[e.jsx(he,{className:"h-3 w-3 mr-1"}),"Verified"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx(me,{className:"h-3 w-3 inline mr-1"}),s.phone]}),e.jsxs("p",{className:"text-sm text-gray-700",children:[s.addressLine1,s.addressLine2&&`, ${s.addressLine2}`,s.landmark&&`, ${s.landmark}`]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx(Se,{className:"h-3 w-3 inline mr-1"}),s.upazila,", ",s.district,", ",s.division," - ",s.postalCode]}),s.deliveryInstructions&&e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[e.jsx(xe,{className:"h-3 w-3 inline mr-1"}),s.deliveryInstructions]}),s.courierPreference&&e.jsxs("p",{className:"text-xs text-gray-500",children:[e.jsx(H,{className:"h-3 w-3 inline mr-1"}),"Preferred: ",s.courierPreference]})]})]}),!B&&e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[!s.isDefault&&e.jsx(c,{variant:"outline",size:"sm",onClick:()=>ae(s.id),disabled:p,children:e.jsx(q,{className:"h-4 w-4"})}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>re(s),children:e.jsx(Fe,{className:"h-4 w-4"})}),e.jsxs(ve,{children:[e.jsx(fe,{asChild:!0,children:e.jsx(c,{variant:"outline",size:"sm",children:e.jsx(Be,{className:"h-4 w-4"})})}),e.jsxs(ye,{children:[e.jsxs(Ce,{children:[e.jsx(Ne,{children:"Delete Address"}),e.jsx(Ae,{children:"Are you sure you want to delete this address? This action cannot be undone."})]}),e.jsxs(De,{children:[e.jsx(be,{children:"Cancel"}),e.jsx(we,{onClick:()=>se(s.id),className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})]})]})]})})},s.id))}),e.jsx(M,{open:Y,onOpenChange:S,children:e.jsxs($,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(R,{children:[e.jsx(G,{children:"Edit Address"}),e.jsx(Q,{children:"Update your delivery address information"})]}),e.jsx(O,{}),e.jsxs(J,{children:[e.jsx(c,{variant:"outline",onClick:()=>{S(!1),P(null),i({type:"home",name:"",phone:"",addressLine1:"",addressLine2:"",landmark:"",division:"",district:"",upazila:"",postalCode:"",deliveryInstructions:"",courierPreference:"",isDefault:!1})},children:"Cancel"}),e.jsx(c,{onClick:V,disabled:p,children:p?"Updating...":"Update Address"})]})]})})]})};export{We as default};
