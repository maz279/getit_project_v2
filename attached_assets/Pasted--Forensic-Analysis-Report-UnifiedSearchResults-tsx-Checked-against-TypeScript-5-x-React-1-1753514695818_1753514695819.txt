ðŸ” Forensic Analysis Report â€“ `UnifiedSearchResults.tsx`  
Checked against: TypeScript 5.x, React 18, Next.js 14, ESLint â€œstrictâ€, WCAG 2.2, OWASP Top-10, Node 20 LTS.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. CRITICAL TYPE / COMPILE ERRORS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1.1 Missing import â€“ Recommendation & InfoByte  
â€¢ Line 39, 41, 45, 164, 186  
  Recommendation & InfoByte are referenced but never defined or imported.  
  âžœ Fix: add the interfaces or import from their source modules.

1.2 No overload for fetch that matches POST body  
â€¢ Line 124, 128, 133  
  fetch() is called with `body: JSON.stringify({ query, language, userHistory, limit })`.  
  `userHistory` is not declared anywhere â†’ TS2339.  
  âžœ Fix: delete or declare `userHistory: any[]`.

1.3 Array.isArray(legacyResults) narrowing unsafe  
â€¢ Line 255, 260, 266  
  `legacyResults` is declared as `SearchResult[] | null | undefined`; accessing `.length` after narrowing may still be undefined.  
  âžœ Add explicit null check: `legacyResults && legacyResults.length > 0`.

1.4 useState<Recommendation[]> without type import  
â€¢ Line 164 â€“ setGroqRecommendations expects Recommendation[] but Recommendation is unknown.  
  âžœ Same as 1.1.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2. RUNTIME / LOGIC ERRORS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2.1 Possible null-pointer in handleProductClick  
â€¢ Line 318 â€“ `result.url?.trim()` may be empty string; empty string is truthy but fails URL constructor.  
  âžœ Change to `if (result.url && URL.canParse(result.url))`.

2.2 XSS in dangerouslySetInnerHTML  
â€¢ Line 512 â€“ conversationalResponse is escaped with `.replace(/</g,'&lt;')` but still allows double-quotes and other HTML entities via â€œdangerouslySetInnerHTMLâ€.  
  âžœ Use a proper sanitizer (DOMPurify) or render as plain text.

2.3 Duplicate key risk  
â€¢ Line 392, 471 â€“ fallback keys (`product-${index}`, `nav-result-${index}`) can collide if server returns numeric IDs.  
  âžœ Prefix with scope: `unified-product-${index}`.

2.4 Potential memory leak  
â€¢ fetchGroqAIRecommendations is triggered on every query change; if query changes rapidly, multiple in-flight requests may resolve out-of-order.  
  âžœ AbortController or debounce.

2.5 Empty recommendations array fallback  
â€¢ generateRecommendations returns empty array when Groq fails; no user feedback.  
  âžœ Surface error state.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
3. ACCESSIBILITY (WCAG 2.2)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
3.1 Non-unique aria-labels  
â€¢ Line 486 â€“ multiple â€œLearn Moreâ€ buttons have identical aria-labels.  
  âžœ Include product title: `aria-label="Learn more about ${title}"`.

3.2 Keyboard trap on cards  
â€¢ Cards have onClick and onKeyDown but no focus ring style; focus may be invisible.  
  âžœ Add `focus:ring-2 focus:ring-offset-2`.

3.3 Missing lang attribute  
â€¢ No `lang={language}` on any text container; screen readers will mispronounce Bengali.  
  âžœ Wrap Bengali content in `<span lang="bn">`.

3.4 Color-contrast failures  
â€¢ Badges with `bg-yellow-100 text-yellow-800` on white card = 2.9:1 (fails 4.5:1).  
  âžœ Darken text to `text-yellow-900`.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
4. SECURITY / BEST-PRACTICE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
4.1 Missing Referrer-Policy  
â€¢ External links (Line 318, 471) use `window.open(url, '_blank')`; should include `rel="noopener noreferrer"`.  
  âžœ Add programmatically: `window.open(url, '_blank', 'noopener,noreferrer')`.

4.2 Exposure of internal API endpoint  
â€¢ `apiEndpoint` prop is logged on error; could leak backend URL.  
  âžœ Sanitize logs.

4.3 Unsafe regex in conversationalResponse  
â€¢ `.replace(/</g,'&lt;')` does not escape `&`, allowing double-encode attacks.  
  âžœ Use library escape-html or Reactâ€™s built-in text rendering.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
5. PERFORMANCE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
5.1 useMemo over-fetching  
â€¢ Line 243 â€“ `memoizedContent` recalculates on every `searchResults` change even when unchanged.  
  âžœ Add deep-equal comparison or use React.memo on child components.

5.2 Unnecessary re-render of section navigation  
â€¢ Section buttons (line 191) are rendered inline; wrap with React.memo or extract.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
6. MISCELLANEOUS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
6.1 CSS class â€œanimate-in slide-in-from-bottom-4â€ used but not defined; Tailwind plugin required.  
6.2 `line-clamp-2` (line 486) is a Tailwind plugin; ensure `@tailwindcss/line-clamp` is installed.  
6.3 Unused imports: Clock, Globe, Users, Zap imported but not used in final render.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
7. SUMMARY â€“ ACTION ITEMS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
A. Add missing interfaces or imports for Recommendation & InfoByte.  
B. Declare `userHistory` or remove from fetch body.  
C. Replace `dangerouslySetInnerHTML` with sanitized JSX.  
D. Fix all null-guard and type-narrowing warnings.  
E. Improve accessibility: unique aria-labels, visible focus rings, lang attributes.  
F. Ensure color contrast â‰¥ 4.5:1 and add `noopener noreferrer` on external links.